import{a0 as u,a1 as te,a2 as re,a3 as Se,a4 as me,a5 as ke,a6 as _e,S as F,i as G,s as Q,l as ne,g as M,I as R,d as v,C as X,P as Y,e as C,t as J,c as I,a as k,h as $,b as l,H as p,a7 as we,k as V,w as A,m as B,x,y as T,j as ge,q as y,o as P,B as E,_ as Oe,a8 as Ce,a9 as Ie,N as j,O as ee,aa as be,v as Me,ab as Ne,n as De,p as ye}from"../../../chunks/vendor-0f82600e.js";import{S as Pe}from"../../../chunks/SecurityCheckPage-6f6f56b9.js";import{P as Re,S as Je}from"../../../chunks/StandardTopBar-e6d1c75c.js";/* empty css                          */import"../../../chunks/singletons-d1fb5791.js";function ie(){return{id:"",name:"",isMobile:!1}}const W={encode(t,e=u.Writer.create()){return t.id!==""&&e.uint32(10).string(t.id),t.name!==""&&e.uint32(18).string(t.name),t.isMobile===!0&&e.uint32(24).bool(t.isMobile),e},decode(t,e){const r=t instanceof u.Reader?t:new u.Reader(t);let n=e===void 0?r.len:r.pos+e;const i=ie();for(;r.pos<n;){const a=r.uint32();switch(a>>>3){case 1:i.id=r.string();break;case 2:i.name=r.string();break;case 3:i.isMobile=r.bool();break;default:r.skipType(a&7);break}}return i},fromJSON(t){return{id:w(t.id)?String(t.id):"",name:w(t.name)?String(t.name):"",isMobile:w(t.isMobile)?Boolean(t.isMobile):!1}},toJSON(t){const e={};return t.id!==void 0&&(e.id=t.id),t.name!==void 0&&(e.name=t.name),t.isMobile!==void 0&&(e.isMobile=t.isMobile),e},fromPartial(t){var r,n,i;const e=ie();return e.id=(r=t.id)!=null?r:"",e.name=(n=t.name)!=null?n:"",e.isMobile=(i=t.isMobile)!=null?i:!1,e}};function ae(){return{offer:""}}const L={encode(t,e=u.Writer.create()){return t.offer!==""&&e.uint32(26).string(t.offer),e},decode(t,e){const r=t instanceof u.Reader?t:new u.Reader(t);let n=e===void 0?r.len:r.pos+e;const i=ae();for(;r.pos<n;){const a=r.uint32();switch(a>>>3){case 3:i.offer=r.string();break;default:r.skipType(a&7);break}}return i},fromJSON(t){return{offer:w(t.offer)?String(t.offer):""}},toJSON(t){const e={};return t.offer!==void 0&&(e.offer=t.offer),e},fromPartial(t){var r;const e=ae();return e.offer=(r=t.offer)!=null?r:"",e}};function se(){return{offer:""}}const z={encode(t,e=u.Writer.create()){return t.offer!==""&&e.uint32(26).string(t.offer),e},decode(t,e){const r=t instanceof u.Reader?t:new u.Reader(t);let n=e===void 0?r.len:r.pos+e;const i=se();for(;r.pos<n;){const a=r.uint32();switch(a>>>3){case 3:i.offer=r.string();break;default:r.skipType(a&7);break}}return i},fromJSON(t){return{offer:w(t.offer)?String(t.offer):""}},toJSON(t){const e={};return t.offer!==void 0&&(e.offer=t.offer),e},fromPartial(t){var r;const e=se();return e.offer=(r=t.offer)!=null?r:"",e}};function oe(){return{answer:""}}const U={encode(t,e=u.Writer.create()){return t.answer!==""&&e.uint32(26).string(t.answer),e},decode(t,e){const r=t instanceof u.Reader?t:new u.Reader(t);let n=e===void 0?r.len:r.pos+e;const i=oe();for(;r.pos<n;){const a=r.uint32();switch(a>>>3){case 3:i.answer=r.string();break;default:r.skipType(a&7);break}}return i},fromJSON(t){return{answer:w(t.answer)?String(t.answer):""}},toJSON(t){const e={};return t.answer!==void 0&&(e.answer=t.answer),e},fromPartial(t){var r;const e=oe();return e.answer=(r=t.answer)!=null?r:"",e}};function ce(){return{iceCandidate:""}}const q={encode(t,e=u.Writer.create()){return t.iceCandidate!==""&&e.uint32(26).string(t.iceCandidate),e},decode(t,e){const r=t instanceof u.Reader?t:new u.Reader(t);let n=e===void 0?r.len:r.pos+e;const i=ce();for(;r.pos<n;){const a=r.uint32();switch(a>>>3){case 3:i.iceCandidate=r.string();break;default:r.skipType(a&7);break}}return i},fromJSON(t){return{iceCandidate:w(t.iceCandidate)?String(t.iceCandidate):""}},toJSON(t){const e={};return t.iceCandidate!==void 0&&(e.iceCandidate=t.iceCandidate),e},fromPartial(t){var r;const e=ce();return e.iceCandidate=(r=t.iceCandidate)!=null?r:"",e}};function de(){return{setName:void 0,p2pMessage:void 0}}const $e={encode(t,e=u.Writer.create()){return t.setName!==void 0&&Z.encode(t.setName,e.uint32(10).fork()).ldelim(),t.p2pMessage!==void 0&&D.encode(t.p2pMessage,e.uint32(18).fork()).ldelim(),e},decode(t,e){const r=t instanceof u.Reader?t:new u.Reader(t);let n=e===void 0?r.len:r.pos+e;const i=de();for(;r.pos<n;){const a=r.uint32();switch(a>>>3){case 1:i.setName=Z.decode(r,r.uint32());break;case 2:i.p2pMessage=D.decode(r,r.uint32());break;default:r.skipType(a&7);break}}return i},fromJSON(t){return{setName:w(t.setName)?Z.fromJSON(t.setName):void 0,p2pMessage:w(t.p2pMessage)?D.fromJSON(t.p2pMessage):void 0}},toJSON(t){const e={};return t.setName!==void 0&&(e.setName=t.setName?Z.toJSON(t.setName):void 0),t.p2pMessage!==void 0&&(e.p2pMessage=t.p2pMessage?D.toJSON(t.p2pMessage):void 0),e},fromPartial(t){const e=de();return e.setName=t.setName!==void 0&&t.setName!==null?Z.fromPartial(t.setName):void 0,e.p2pMessage=t.p2pMessage!==void 0&&t.p2pMessage!==null?D.fromPartial(t.p2pMessage):void 0,e}};function le(){return{id:"",name:""}}const Z={encode(t,e=u.Writer.create()){return t.id!==""&&e.uint32(10).string(t.id),t.name!==""&&e.uint32(18).string(t.name),e},decode(t,e){const r=t instanceof u.Reader?t:new u.Reader(t);let n=e===void 0?r.len:r.pos+e;const i=le();for(;r.pos<n;){const a=r.uint32();switch(a>>>3){case 1:i.id=r.string();break;case 2:i.name=r.string();break;default:r.skipType(a&7);break}}return i},fromJSON(t){return{id:w(t.id)?String(t.id):"",name:w(t.name)?String(t.name):""}},toJSON(t){const e={};return t.id!==void 0&&(e.id=t.id),t.name!==void 0&&(e.name=t.name),e},fromPartial(t){var r,n;const e=le();return e.id=(r=t.id)!=null?r:"",e.name=(n=t.name)!=null?n:"",e}};function fe(){return{connectedDevices:[]}}const K={encode(t,e=u.Writer.create()){for(const r of t.connectedDevices)W.encode(r,e.uint32(18).fork()).ldelim();return e},decode(t,e){const r=t instanceof u.Reader?t:new u.Reader(t);let n=e===void 0?r.len:r.pos+e;const i=fe();for(;r.pos<n;){const a=r.uint32();switch(a>>>3){case 2:i.connectedDevices.push(W.decode(r,r.uint32()));break;default:r.skipType(a&7);break}}return i},fromJSON(t){return{connectedDevices:Array.isArray(t==null?void 0:t.connectedDevices)?t.connectedDevices.map(e=>W.fromJSON(e)):[]}},toJSON(t){const e={};return t.connectedDevices?e.connectedDevices=t.connectedDevices.map(r=>r?W.toJSON(r):void 0):e.connectedDevices=[],e},fromPartial(t){var r;const e=fe();return e.connectedDevices=((r=t.connectedDevices)==null?void 0:r.map(n=>W.fromPartial(n)))||[],e}};function ue(){return{serverState:void 0,p2pMessage:void 0}}const Ae={encode(t,e=u.Writer.create()){return t.serverState!==void 0&&K.encode(t.serverState,e.uint32(10).fork()).ldelim(),t.p2pMessage!==void 0&&D.encode(t.p2pMessage,e.uint32(18).fork()).ldelim(),e},decode(t,e){const r=t instanceof u.Reader?t:new u.Reader(t);let n=e===void 0?r.len:r.pos+e;const i=ue();for(;r.pos<n;){const a=r.uint32();switch(a>>>3){case 1:i.serverState=K.decode(r,r.uint32());break;case 2:i.p2pMessage=D.decode(r,r.uint32());break;default:r.skipType(a&7);break}}return i},fromJSON(t){return{serverState:w(t.serverState)?K.fromJSON(t.serverState):void 0,p2pMessage:w(t.p2pMessage)?D.fromJSON(t.p2pMessage):void 0}},toJSON(t){const e={};return t.serverState!==void 0&&(e.serverState=t.serverState?K.toJSON(t.serverState):void 0),t.p2pMessage!==void 0&&(e.p2pMessage=t.p2pMessage?D.toJSON(t.p2pMessage):void 0),e},fromPartial(t){const e=ue();return e.serverState=t.serverState!==void 0&&t.serverState!==null?K.fromPartial(t.serverState):void 0,e.p2pMessage=t.p2pMessage!==void 0&&t.p2pMessage!==null?D.fromPartial(t.p2pMessage):void 0,e}};function ve(){return{senderId:"",receiverId:"",initialRtcOffer:void 0,rtcOffer:void 0,rtcAnswer:void 0,iceCandidate:void 0}}const D={encode(t,e=u.Writer.create()){return t.senderId!==""&&e.uint32(10).string(t.senderId),t.receiverId!==""&&e.uint32(18).string(t.receiverId),t.initialRtcOffer!==void 0&&L.encode(t.initialRtcOffer,e.uint32(26).fork()).ldelim(),t.rtcOffer!==void 0&&z.encode(t.rtcOffer,e.uint32(34).fork()).ldelim(),t.rtcAnswer!==void 0&&U.encode(t.rtcAnswer,e.uint32(42).fork()).ldelim(),t.iceCandidate!==void 0&&q.encode(t.iceCandidate,e.uint32(50).fork()).ldelim(),e},decode(t,e){const r=t instanceof u.Reader?t:new u.Reader(t);let n=e===void 0?r.len:r.pos+e;const i=ve();for(;r.pos<n;){const a=r.uint32();switch(a>>>3){case 1:i.senderId=r.string();break;case 2:i.receiverId=r.string();break;case 3:i.initialRtcOffer=L.decode(r,r.uint32());break;case 4:i.rtcOffer=z.decode(r,r.uint32());break;case 5:i.rtcAnswer=U.decode(r,r.uint32());break;case 6:i.iceCandidate=q.decode(r,r.uint32());break;default:r.skipType(a&7);break}}return i},fromJSON(t){return{senderId:w(t.senderId)?String(t.senderId):"",receiverId:w(t.receiverId)?String(t.receiverId):"",initialRtcOffer:w(t.initialRtcOffer)?L.fromJSON(t.initialRtcOffer):void 0,rtcOffer:w(t.rtcOffer)?z.fromJSON(t.rtcOffer):void 0,rtcAnswer:w(t.rtcAnswer)?U.fromJSON(t.rtcAnswer):void 0,iceCandidate:w(t.iceCandidate)?q.fromJSON(t.iceCandidate):void 0}},toJSON(t){const e={};return t.senderId!==void 0&&(e.senderId=t.senderId),t.receiverId!==void 0&&(e.receiverId=t.receiverId),t.initialRtcOffer!==void 0&&(e.initialRtcOffer=t.initialRtcOffer?L.toJSON(t.initialRtcOffer):void 0),t.rtcOffer!==void 0&&(e.rtcOffer=t.rtcOffer?z.toJSON(t.rtcOffer):void 0),t.rtcAnswer!==void 0&&(e.rtcAnswer=t.rtcAnswer?U.toJSON(t.rtcAnswer):void 0),t.iceCandidate!==void 0&&(e.iceCandidate=t.iceCandidate?q.toJSON(t.iceCandidate):void 0),e},fromPartial(t){var r,n;const e=ve();return e.senderId=(r=t.senderId)!=null?r:"",e.receiverId=(n=t.receiverId)!=null?n:"",e.initialRtcOffer=t.initialRtcOffer!==void 0&&t.initialRtcOffer!==null?L.fromPartial(t.initialRtcOffer):void 0,e.rtcOffer=t.rtcOffer!==void 0&&t.rtcOffer!==null?z.fromPartial(t.rtcOffer):void 0,e.rtcAnswer=t.rtcAnswer!==void 0&&t.rtcAnswer!==null?U.fromPartial(t.rtcAnswer):void 0,e.iceCandidate=t.iceCandidate!==void 0&&t.iceCandidate!==null?q.fromPartial(t.iceCandidate):void 0,e}};u.util.Long!==te&&(u.util.Long=te,u.configure());function w(t){return t!=null}function xe(t){const{url:e,isDevice:r,clientId:n}=t;let i=new URL(e+"/events");i.searchParams.append("stream",n);let a=e+"/command";const s=new Se(o=>{const h=new EventSource(i,{withCredentials:!1});return h.onmessage=d=>{o.closed||o.next(Ae.decode(re.Buffer.from(d.data,"base64")))},()=>h.close()}).pipe(me({resetOnError:!1,resetOnComplete:!1,resetOnRefCountZero:!0}));return{sendCommand(o){fetch(a,{method:"POST",body:re.Buffer.from($e.encode(o).finish()).toString("base64")})},onMessage(){return s}}}class Te{constructor(e){this.robotService=e}async onIceCandidate(e,r,n){this.robotService.sendCommand({p2pMessage:{senderId:e,receiverId:r,iceCandidate:{iceCandidate:JSON.stringify(n)}}})}async sendInitialOffer(e,r,n){this.robotService.sendCommand({p2pMessage:{senderId:e,receiverId:r,initialRtcOffer:{offer:JSON.stringify(n)}}})}async sendAnswer(e,r,n){this.robotService.sendCommand({p2pMessage:{senderId:e,receiverId:r,rtcAnswer:{answer:JSON.stringify(n)}}})}}class Ee{constructor(e){const{clientId:r,onMedia:n,peerId:i,rtcpHandler:a}=e;this.clientId=r,this.peerId=i,this.rtcpPeerConnection=new RTCPeerConnection,this.rtcpHandler=a,this.signalizationDataChannel=this.rtcpPeerConnection.createDataChannel("signalization",{id:0,ordered:!0}),this.rtcpPeerConnection.onicecandidate=s=>{this.rtcpHandler.onIceCandidate(this.clientId,i,s.candidate)},n({state:"notReady"}),this.rtcpPeerConnection.ontrack=s=>{s.track.onended=()=>{n({state:"notReady"})},s.track.readyState=="live"&&n({state:"ready",mediaStream:s.streams[0]})}}close(){this.rtcpPeerConnection.close()}async call(){const e=await this.rtcpPeerConnection.createOffer({offerToReceiveVideo:!0});await this.rtcpPeerConnection.setLocalDescription(e),await this.rtcpHandler.sendInitialOffer(this.clientId,this.peerId,e)}async receiveInitialOfferAndSendAnswer(e){await this.rtcpPeerConnection.setRemoteDescription(e);const r=await this.rtcpPeerConnection.createAnswer();await this.rtcpPeerConnection.setLocalDescription(r),this.rtcpHandler.sendAnswer(this.clientId,this.peerId,r)}async addIceCandidate(e){try{await this.rtcpPeerConnection.addIceCandidate(e)}catch(r){console.log(r)}}async receiveOffer(e){await this.rtcpPeerConnection.setRemoteDescription(e)}sendMessage(e){this.signalizationDataChannel.send(e)}}class Ve{constructor(e){this.state=new ke({type:"NotPeered"});const{onDevices:r,onMedia:n,clientId:i,signalingServerUrl:a}=e;this.clientId=i,this.onMedia=n;const s=xe({url:a,isDevice:!1,clientId:this.clientId});this.rtcpHandler=new Te(s),this.serverObservable=s.onMessage().pipe(_e(async o=>{var h;switch(!0){case o.p2pMessage!=null:{const d=o.p2pMessage,c=d.senderId;if(c!=((h=this.rtcPeerDecorator)==null?void 0:h.peerId))return;switch(!0){case d.initialRtcOffer!=null:{this.rtcPeerDecorator=this.createRTCPDecorator(c),await this.rtcPeerDecorator.receiveInitialOfferAndSendAnswer(JSON.parse(d.initialRtcOffer.offer));break}case d.iceCandidate!=null:{await this.rtcPeerDecorator.addIceCandidate(JSON.parse(d.iceCandidate.iceCandidate));break}case d.rtcOffer!=null:{await this.rtcPeerDecorator.receiveOffer(JSON.parse(d.rtcOffer.offer));break}case d.rtcAnswer!=null:{await this.rtcPeerDecorator.receiveOffer(JSON.parse(d.rtcAnswer.answer));break}}break}case o.serverState!=null:{const{connectedDevices:d}=o.serverState;r(d),d.find(c=>c.id!=this.clientId)||this.closeCurrentCall()}}return o}),me({resetOnError:!1,resetOnComplete:!1,resetOnRefCountZero:!0}))}start(){this.subscription=this.serverObservable.subscribe()}stop(){var e;(e=this.subscription)==null||e.unsubscribe()}call(e){this.rtcPeerDecorator=this.createRTCPDecorator(e),this.rtcPeerDecorator.call(),this.state.next({type:"Peered",peerId:e})}sendMessage(e){var r;(r=this.rtcPeerDecorator)==null||r.sendMessage(e)}closeCurrentCall(){var e;(e=this.rtcPeerDecorator)==null||e.close(),this.rtcPeerDecorator=null,this.state.next({type:"NotPeered"})}createRTCPDecorator(e){return this.rtcPeerDecorator&&this.closeCurrentCall(),new Ee({clientId:this.clientId,onMedia:this.onMedia,peerId:e,rtcpHandler:this.rtcpHandler})}}function Be(t){let e,r,n;return{c(){e=C("div"),r=J("Video not available"),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);r=$(a,"Video not available"),a.forEach(v),this.h()},h(){l(e,"class",n=`${t[2].class} bg-slate-200 text-lg`)},m(i,a){M(i,e,a),p(e,r)},p(i,a){a&4&&n!==(n=`${i[2].class} bg-slate-200 text-lg`)&&l(e,"class",n)},d(i){i&&v(e)}}}function He(t){let e,r,n,i,a;return{c(){e=C("video"),r=C("track"),this.h()},l(s){e=I(s,"VIDEO",{class:!0});var o=k(e);r=I(o,"TRACK",{kind:!0}),o.forEach(v),this.h()},h(){l(r,"kind","captions"),e.autoplay=!0,l(e,"class",n=t[2].class)},m(s,o){M(s,e,o),p(e,r),i||(a=we(t[1].call(null,e)),i=!0)},p(s,o){o&4&&n!==(n=s[2].class)&&l(e,"class",n)},d(s){s&&v(e),i=!1,a()}}}function We(t){let e;function r(a,s){return a[0]&&a[0].state=="ready"?He:Be}let n=r(t),i=n(t);return{c(){i.c(),e=ne()},l(a){i.l(a),e=ne()},m(a,s){i.m(a,s),M(a,e,s)},p(a,[s]){n===(n=r(a))&&i?i.p(a,s):(i.d(1),i=n(a),i&&(i.c(),i.m(e.parentNode,e)))},i:R,o:R,d(a){i.d(a),a&&v(e)}}}function Le(t,e,r){let{mediaState:n}=e;function i(a){n&&n.state=="ready"&&(a.srcObject=n.mediaStream)}return t.$$set=a=>{r(2,e=X(X({},e),Y(a))),"mediaState"in a&&r(0,n=a.mediaState)},e=Y(e),[n,i,e]}class ze extends F{constructor(e){super();G(this,e,Le,We,Q,{mediaState:0})}}function Ue(t){let e,r,n,i,a,s,o,h,d;return o=new ze({props:{mediaState:t[1],class:"flex flex-grow place-content-center place-items-center bg-black rounded-2xl aspect-video h-96"}}),{c(){e=C("div"),r=C("div"),n=C("span"),i=J("Device Id"),a=J(t[0]),s=V(),A(o.$$.fragment),this.h()},l(c){e=I(c,"DIV",{class:!0});var f=k(e);r=I(f,"DIV",{class:!0});var m=k(r);n=I(m,"SPAN",{class:!0});var _=k(n);i=$(_,"Device Id"),_.forEach(v),a=$(m,t[0]),m.forEach(v),s=B(f),x(o.$$.fragment,f),f.forEach(v),this.h()},h(){l(n,"class","bg-light-gray text-bluestrong text-sm font-medium mr-2 px-2.5 py-0.5 rounded"),l(r,"class","my-3"),l(e,"class",h=t[2].class)},m(c,f){M(c,e,f),p(e,r),p(r,n),p(n,i),p(r,a),p(e,s),T(o,e,null),d=!0},p(c,[f]){(!d||f&1)&&ge(a,c[0]);const m={};f&2&&(m.mediaState=c[1]),o.$set(m),(!d||f&4&&h!==(h=c[2].class))&&l(e,"class",h)},i(c){d||(y(o.$$.fragment,c),d=!0)},o(c){P(o.$$.fragment,c),d=!1},d(c){c&&v(e),E(o)}}}function qe(t,e,r){let{peerId:n}=e,{mediaState:i}=e;return t.$$set=a=>{r(2,e=X(X({},e),Y(a))),"peerId"in a&&r(0,n=a.peerId),"mediaState"in a&&r(1,i=a.mediaState)},e=Y(e),[n,i,e]}class Ze extends F{constructor(e){super();G(this,e,qe,Ue,Q,{peerId:0,mediaState:1})}}function he(t,e,r){const n=t.slice();return n[4]=e[r],n}function Ke(t){let e,r;return{c(){e=j("svg"),r=j("path"),this.h()},l(n){e=ee(n,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var i=k(e);r=ee(i,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),k(r).forEach(v),i.forEach(v),this.h()},h(){l(r,"stroke-linecap","round"),l(r,"stroke-linejoin","round"),l(r,"stroke-width","2"),l(r,"d","M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"),l(e,"xmlns","http://www.w3.org/2000/svg"),l(e,"class","h-6 w-6 mr-2"),l(e,"fill","none"),l(e,"viewBox","0 0 24 24"),l(e,"stroke","currentColor")},m(n,i){M(n,e,i),p(e,r)},d(n){n&&v(e)}}}function Fe(t){let e,r;return{c(){e=j("svg"),r=j("path"),this.h()},l(n){e=ee(n,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var i=k(e);r=ee(i,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),k(r).forEach(v),i.forEach(v),this.h()},h(){l(r,"stroke-linecap","round"),l(r,"stroke-linejoin","round"),l(r,"stroke-width","2"),l(r,"d","M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"),l(e,"xmlns","http://www.w3.org/2000/svg"),l(e,"class","h-6 w-6 mr-2"),l(e,"fill","none"),l(e,"viewBox","0 0 24 24"),l(e,"stroke","currentColor")},m(n,i){M(n,e,i),p(e,r)},d(n){n&&v(e)}}}function pe(t,e){let r,n,i,a,s=e[4].id+"",o,h,d,c,f;function m(g,O){return g[4].isMobile?Fe:Ke}let _=m(e),b=_(e);function S(){return e[3](e[4])}return{key:t,first:null,c(){r=C("div"),n=C("div"),b.c(),i=V(),a=C("div"),o=J(s),d=V(),this.h()},l(g){r=I(g,"DIV",{class:!0});var O=k(r);n=I(O,"DIV",{class:!0});var N=k(n);b.l(N),i=B(N),a=I(N,"DIV",{});var H=k(a);o=$(H,s),H.forEach(v),N.forEach(v),d=B(O),O.forEach(v),this.h()},h(){l(n,"class",h="flex flex-row rounded-lg p-1 "+(e[2]==e[4].id?"bg-bluelight":"bg-light")+" border-2 hover:bg-sky-200 cursor-pointer transition-transform origin-right duration-100 hover:border-2 hover:border-sky-400"),l(r,"class","box-border my-2 px-3"),this.first=r},m(g,O){M(g,r,O),p(r,n),b.m(n,null),p(n,i),p(n,a),p(a,o),p(r,d),c||(f=Oe(n,"click",S),c=!0)},p(g,O){e=g,_!==(_=m(e))&&(b.d(1),b=_(e),b&&(b.c(),b.m(n,i))),O&1&&s!==(s=e[4].id+"")&&ge(o,s),O&5&&h!==(h="flex flex-row rounded-lg p-1 "+(e[2]==e[4].id?"bg-bluelight":"bg-light")+" border-2 hover:bg-sky-200 cursor-pointer transition-transform origin-right duration-100 hover:border-2 hover:border-sky-400")&&l(n,"class",h)},d(g){g&&v(r),b.d(),c=!1,f()}}}function Ge(t){let e,r,n,i,a,s=[],o=new Map,h=t[0];const d=c=>c[4].id;for(let c=0;c<h.length;c+=1){let f=he(t,h,c),m=d(f);o.set(m,s[c]=pe(m,f))}return{c(){e=C("div"),r=C("div"),n=J("Available devices"),i=V(),a=C("div");for(let c=0;c<s.length;c+=1)s[c].c();this.h()},l(c){e=I(c,"DIV",{class:!0});var f=k(e);r=I(f,"DIV",{class:!0});var m=k(r);n=$(m,"Available devices"),m.forEach(v),f.forEach(v),i=B(c),a=I(c,"DIV",{class:!0});var _=k(a);for(let b=0;b<s.length;b+=1)s[b].l(_);_.forEach(v),this.h()},h(){l(r,"class","text-center text-gray"),l(e,"class","w-full shadow-sm py-2"),l(a,"class","overflow-y-scroll")},m(c,f){M(c,e,f),p(e,r),p(r,n),M(c,i,f),M(c,a,f);for(let m=0;m<s.length;m+=1)s[m].m(a,null)},p(c,[f]){f&7&&(h=c[0],s=Ce(s,f,d,1,c,h,o,a,Ie,pe,null,he))},i:R,o:R,d(c){c&&v(e),c&&v(i),c&&v(a);for(let f=0;f<s.length;f+=1)s[f].d()}}}function Qe(t,e,r){let{devices:n}=e,{selectDevice:i}=e,a="";const s=o=>{r(2,a=o.id),i(o.id)};return t.$$set=o=>{"devices"in o&&r(0,n=o.devices),"selectDevice"in o&&r(1,i=o.selectDevice)},[n,i,a,s]}class Xe extends F{constructor(e){super();G(this,e,Qe,Ge,Q,{devices:0,selectDevice:1})}}function Ye(t){let e,r;return e=new Je({props:{slot:"topbar"}}),{c(){A(e.$$.fragment)},l(n){x(e.$$.fragment,n)},m(n,i){T(e,n,i),r=!0},p:R,i(n){r||(y(e.$$.fragment,n),r=!0)},o(n){P(e.$$.fragment,n),r=!1},d(n){E(e,n)}}}function je(t){let e,r;return{c(){e=C("div"),r=J("Select a device"),this.h()},l(n){e=I(n,"DIV",{class:!0});var i=k(e);r=$(i,"Select a device"),i.forEach(v),this.h()},h(){l(e,"class","flex flex-grow place-items-center place-content-center text-xl text-gray")},m(n,i){M(n,e,i),p(e,r)},p:R,i:R,o:R,d(n){n&&v(e)}}}function et(t){let e,r;return e=new Ze({props:{class:"flex flex-grow flex-col",peerId:t[2].peerId,mediaState:t[1]}}),{c(){A(e.$$.fragment)},l(n){x(e.$$.fragment,n)},m(n,i){T(e,n,i),r=!0},p(n,i){const a={};i&4&&(a.peerId=n[2].peerId),i&2&&(a.mediaState=n[1]),e.$set(a)},i(n){r||(y(e.$$.fragment,n),r=!0)},o(n){P(e.$$.fragment,n),r=!1},d(n){E(e,n)}}}function tt(t){let e,r,n,i,a,s,o,h,d,c,f;const m=[et,je],_=[];function b(S,g){return S[2]&&S[2].type=="Peered"?0:1}return s=b(t),o=_[s]=m[s](t),c=new Xe({props:{selectDevice:t[4],devices:t[0]}}),{c(){e=C("div"),r=C("div"),n=C("div"),i=J("Control center"),a=V(),o.c(),h=V(),d=C("div"),A(c.$$.fragment),this.h()},l(S){e=I(S,"DIV",{slot:!0,class:!0});var g=k(e);r=I(g,"DIV",{class:!0});var O=k(r);n=I(O,"DIV",{class:!0});var N=k(n);i=$(N,"Control center"),N.forEach(v),a=B(O),o.l(O),O.forEach(v),h=B(g),d=I(g,"DIV",{class:!0});var H=k(d);x(c.$$.fragment,H),H.forEach(v),g.forEach(v),this.h()},h(){l(n,"class","text-3xl text-gray font-thin"),l(r,"class","flex flex-grow flex-col m-5"),l(d,"class","flex flex-col flex-grow max-w-md shadow-md"),l(e,"slot","main"),l(e,"class","flex flex-row flex-grow")},m(S,g){M(S,e,g),p(e,r),p(r,n),p(n,i),p(r,a),_[s].m(r,null),p(e,h),p(e,d),T(c,d,null),f=!0},p(S,g){let O=s;s=b(S),s===O?_[s].p(S,g):(De(),P(_[O],1,1,()=>{_[O]=null}),ye(),o=_[s],o?o.p(S,g):(o=_[s]=m[s](S),o.c()),y(o,1),o.m(r,null));const N={};g&8&&(N.selectDevice=S[4]),g&1&&(N.devices=S[0]),c.$set(N)},i(S){f||(y(o),y(c.$$.fragment,S),f=!0)},o(S){P(o),P(c.$$.fragment,S),f=!1},d(S){S&&v(e),_[s].d(),E(c)}}}function rt(t){let e,r;return e=new Re({props:{$$slots:{main:[tt],topbar:[Ye]},$$scope:{ctx:t}}}),{c(){A(e.$$.fragment)},l(n){x(e.$$.fragment,n)},m(n,i){T(e,n,i),r=!0},p(n,[i]){const a={};i&79&&(a.$$scope={dirty:i,ctx:n}),e.$set(a)},i(n){r||(y(e.$$.fragment,n),r=!0)},o(n){P(e.$$.fragment,n),r=!1},d(n){E(e,n)}}}function nt(t,e,r){let n=be(),i=[],a,s,o;return Me(()=>{r(3,o=new Ve({clientId:n,onDevices:d=>{r(0,i=d.filter(c=>c.id!=n))},onMedia:d=>{r(1,a=d)},signalingServerUrl:"http://localhost:8080"})),o.start(),o.state.subscribe({next:d=>{r(2,s=d)}})}),Ne(()=>{o==null||o.stop()}),[i,a,s,o,d=>{o.call(d)}]}class it extends F{constructor(e){super();G(this,e,nt,rt,Q,{})}}function at(t){let e,r;return e=new it({}),{c(){A(e.$$.fragment)},l(n){x(e.$$.fragment,n)},m(n,i){T(e,n,i),r=!0},i(n){r||(y(e.$$.fragment,n),r=!0)},o(n){P(e.$$.fragment,n),r=!1},d(n){E(e,n)}}}function st(t){let e,r;return e=new Pe({props:{denyIfNotAuthenticated:!0,$$slots:{default:[at]},$$scope:{ctx:t}}}),{c(){A(e.$$.fragment)},l(n){x(e.$$.fragment,n)},m(n,i){T(e,n,i),r=!0},p(n,[i]){const a={};i&1&&(a.$$scope={dirty:i,ctx:n}),e.$set(a)},i(n){r||(y(e.$$.fragment,n),r=!0)},o(n){P(e.$$.fragment,n),r=!1},d(n){E(e,n)}}}class ut extends F{constructor(e){super();G(this,e,null,st,Q,{})}}export{ut as default};
